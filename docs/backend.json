{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the SmartLearn AI platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "progress": {
          "type": "array",
          "description": "An array of topic IDs indicating the user's progress in each topic.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "email"
      ]
    },
    "Topic": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Topic",
      "type": "object",
      "description": "Represents a learning topic available on the platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the topic entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the topic."
        },
        "createdBy": {
          "type": "string",
          "description": "Reference to the User who created the topic. (Relationship: User 1:N Topic)"
        },
        "roadmap": {
          "type": "array",
          "description": "An array of Roadmap IDs associated with this topic.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "title",
        "createdBy",
        "roadmap"
      ]
    },
    "Roadmap": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Roadmap",
      "type": "object",
      "description": "Represents a learning roadmap, which is a sequence of steps for a topic.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the roadmap entity."
        },
        "stepNumber": {
          "type": "number",
          "description": "The step number in the roadmap sequence."
        },
        "stepTitle": {
          "type": "string",
          "description": "The title of the step."
        },
        "description": {
          "type": "string",
          "description": "A description of what the step covers."
        },
        "lessons": {
          "type": "array",
          "description": "An array of Lesson IDs associated with this step.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "stepNumber",
        "stepTitle",
        "description",
        "lessons"
      ]
    },
    "Lesson": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Lesson",
      "type": "object",
      "description": "Represents a lesson within a learning step.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the lesson entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the lesson."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the lesson."
        },
        "youtubeLink": {
          "type": "string",
          "description": "A link to a YouTube video associated with the lesson.",
          "format": "uri"
        },
        "status": {
          "type": "string",
          "description": "The status of the lesson (To Learn, Learning, Learned).",
          "format": "string"
        },
        "testId": {
          "type": "string",
          "description": "Reference to the Test associated with this lesson. (Relationship: Lesson 1:1 Test)"
        }
      },
      "required": [
        "id",
        "title",
        "description",
        "youtubeLink",
        "status",
        "testId"
      ]
    },
    "Test": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Test",
      "type": "object",
      "description": "Represents a test or quiz associated with a lesson.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the test entity."
        },
        "lessonId": {
          "type": "string",
          "description": "Reference to the Lesson this test belongs to. (Relationship: Lesson 1:1 Test)"
        },
        "questions": {
          "type": "array",
          "description": "An array of questions in the test.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "lessonId",
        "questions"
      ]
    },
    "DailyTask": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DailyTask",
      "type": "object",
      "description": "Represents a daily learning task assigned to a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the daily task entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User assigned to this task. (Relationship: User 1:N DailyTask)"
        },
        "topicId": {
          "type": "string",
          "description": "Reference to the Topic this task belongs to. (Relationship: Topic 1:N DailyTask)"
        },
        "lessonId": {
          "type": "string",
          "description": "Reference to the Lesson associated with this task. (Relationship: Lesson 1:N DailyTask)"
        },
        "date": {
          "type": "string",
          "description": "The date for which the task is assigned.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The status of the daily task."
        }
      },
      "required": [
        "id",
        "userId",
        "topicId",
        "lessonId",
        "date",
        "status"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com",
      "apple.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles, including name, email, and progress. It facilitates path-based ownership for user-specific data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/topics/{topicId}",
        "definition": {
          "entityName": "Topic",
          "schema": {
            "$ref": "#/backend/entities/Topic"
          },
          "description": "Stores learning topics, including title, creator, and associated roadmaps. Includes denormalized `createdBy` field for authorization independence.",
          "params": [
            {
              "name": "topicId",
              "description": "The unique identifier for the topic."
            }
          ]
        }
      },
      {
        "path": "/topics/{topicId}/roadmaps/{roadmapId}",
        "definition": {
          "entityName": "Roadmap",
          "schema": {
            "$ref": "#/backend/entities/Roadmap"
          },
          "description": "Stores learning roadmaps associated with a specific topic, detailing the steps for each roadmap.",
          "params": [
            {
              "name": "topicId",
              "description": "The unique identifier for the topic."
            },
            {
              "name": "roadmapId",
              "description": "The unique identifier for the roadmap."
            }
          ]
        }
      },
      {
        "path": "/topics/{topicId}/roadmaps/{roadmapId}/lessons/{lessonId}",
        "definition": {
          "entityName": "Lesson",
          "schema": {
            "$ref": "#/backend/entities/Lesson"
          },
          "description": "Stores lessons associated with a specific roadmap step, providing details like title, description, YouTube link, and status.",
          "params": [
            {
              "name": "topicId",
              "description": "The unique identifier for the topic."
            },
            {
              "name": "roadmapId",
              "description": "The unique identifier for the roadmap."
            },
            {
              "name": "lessonId",
              "description": "The unique identifier for the lesson."
            }
          ]
        }
      },
      {
        "path": "/lessons/{lessonId}/tests/{testId}",
        "definition": {
          "entityName": "Test",
          "schema": {
            "$ref": "#/backend/entities/Test"
          },
          "description": "Stores tests associated with a specific lesson, including questions.",
          "params": [
            {
              "name": "lessonId",
              "description": "The unique identifier for the lesson."
            },
            {
              "name": "testId",
              "description": "The unique identifier for the test."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/dailyTasks/{dailyTaskId}",
        "definition": {
          "entityName": "DailyTask",
          "schema": {
            "$ref": "#/backend/entities/DailyTask"
          },
          "description": "Stores daily tasks assigned to users, referencing the associated topic, lesson, and date.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "dailyTaskId",
              "description": "The unique identifier for the daily task."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support the SmartLearn AI platform, focusing on user-specific learning paths and AI-generated content. User data is stored under `/users/{userId}`, ensuring private user data. Topics are organized under `/topics/{topicId}`, each created by a specific user, establishing a clear ownership model. The roadmap, lessons, tests and daily tasks follow a similar pattern with hierarchical paths `/topics/{topicId}/roadmaps/{roadmapId}`, `/topics/{topicId}/roadmaps/{roadmapId}/lessons/{lessonId}`, `/lessons/{lessonId}/tests/{testId}`, and `/users/{userId}/dailyTasks/{dailyTaskId}`. This structure facilitates easy querying and management of learning resources associated with particular topics and users. The design allows for atomic operations on user-specific data and easy scaling as the platform grows. Crucially, Authorization Independence is achieved by storing the `createdBy` field in the `Topic` documents. This denormalization avoids the need for `get()` calls in security rules when determining authorization for reading or writing topics, roadmaps, lessons and tests."
  }
}
