
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the SmartLearn AI platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "name",
        "email"
      ]
    },
    "Topic": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Topic",
      "type": "object",
      "description": "Represents a learning topic (e.g., 'Python', 'Guitar').",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the topic entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the topic."
        },
        "createdBy": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Topic) The ID of the user who created the topic."
        }
      },
      "required": [
        "id",
        "title",
        "createdBy"
      ]
    },
    "Roadmap": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Roadmap",
      "type": "object",
      "description": "Represents a learning roadmap for a topic, consisting of multiple steps.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the roadmap entity."
        },
        "stepNumber": {
          "type": "number",
          "description": "The order number of this step in the roadmap."
        },
        "stepTitle": {
          "type": "string",
          "description": "The title of this step in the roadmap."
        },
        "description": {
          "type": "string",
          "description": "A description of what the step covers."
        }
      },
      "required": [
        "id",
        "stepNumber",
        "stepTitle",
        "description"
      ]
    },
    "Lesson": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Lesson",
      "type": "object",
      "description": "Represents a single lesson within a roadmap step.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the lesson entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the lesson."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the lesson content."
        },
        "youtubeLink": {
          "type": "string",
          "description": "Link to a YouTube video associated with the lesson.",
          "format": "uri"
        },
        "status": {
          "type": "string",
          "description": "The status of the lesson (To Learn, Learning, Learned).",
          "items": {
            "type": "string"
          }
        },
        "has_quiz": {
            "type": "boolean",
            "description": "Indicates if a quiz is associated with this lesson."
        },
        "quiz_id": {
            "type": "string",
            "description": "The ID of the quiz associated with this lesson, if it exists."
        },
        "quiz_ready": {
            "type": "boolean",
            "description": "Indicates if the quiz has been generated and is ready."
        }
      },
      "required": [
        "id",
        "title",
        "description",
        "status"
      ]
    },
    "Test": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Test",
      "type": "object",
      "description": "Represents a test/quiz associated with a lesson.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the test entity."
        },
        "questions": {
          "type": "array",
          "description": "An array of question objects for the test.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "questions"
      ]
    },
    "DailyTask": {
      "$schema": "http://json-schema.org/draft.OFF-07/schema#",
      "title": "DailyTask",
      "type": "object",
      "description": "Represents a daily learning task assigned to a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the daily task entity."
        },
        "lessonId": {
          "type": "string",
          "description": "Reference to Lesson. (Relationship: Lesson 1:N DailyTask) The ID of the lesson associated with the task."
        },
        "date": {
          "type": "string",
          "description": "The date the task is assigned for.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The status of the task (e.g., 'Completed', 'Pending')."
        }
      },
      "required": [
        "id",
        "lessonId",
        "date",
        "status"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "google.com",
      "apple.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. The 'userId' parameter corresponds to the Firebase Authentication UID.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/topics/{topicId}",
        "definition": {
          "entityName": "Topic",
          "schema": {
            "$ref": "#/backend/entities/Topic"
          },
          "description": "Stores topics created by a specific user. Includes denormalized 'createdBy' field for authorization independence.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user who owns the topic."
            },
            {
              "name": "topicId",
              "description": "The unique identifier for the topic."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/topics/{topicId}/roadmaps/{roadmapId}",
        "definition": {
          "entityName": "Roadmap",
          "schema": {
            "$ref": "#/backend/entities/Roadmap"
          },
          "description": "Stores roadmaps created by a specific user for a topic.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user who owns the roadmap."
            },
            {
              "name": "topicId",
              "description": "The unique identifier for the parent topic."
            },
            {
              "name": "roadmapId",
              "description": "The unique identifier for the roadmap."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/topics/{topicId}/roadmaps/{roadmapId}/lessons/{lessonId}",
        "definition": {
          "entityName": "Lesson",
          "schema": {
            "$ref": "#/backend/entities/Lesson"
          },
          "description": "Stores lessons associated with a specific roadmap.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user who owns the lesson."
            },
            {
              "name": "topicId",
              "description": "The unique identifier for the parent topic."
            },
            {
              "name": "roadmapId",
              "description": "The unique identifier for the roadmap."
            },
            {
              "name": "lessonId",
              "description": "The unique identifier for the lesson."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/topics/{topicId}/roadmaps/{roadmapId}/lessons/{lessonId}/tests/{testId}",
        "definition": {
          "entityName": "Test",
          "schema": {
            "$ref": "#/backend/entities/Test"
          },
          "description": "Stores tests associated with a specific lesson.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user who owns the test."
            },
            {
              "name": "topicId",
              "description": "The unique identifier for the parent topic."
            },
            {
              "name": "roadmapId",
              "description": "The unique identifier for the roadmap."
            },
            {
              "name": "lessonId",
              "description": "The unique identifier for the lesson."
            },
            {
              "name": "testId",
              "description": "The unique identifier for the test."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/dailyTasks/{dailyTaskId}",
        "definition": {
          "entityName": "DailyTask",
          "schema": {
            "$ref": "#/backend/entities/DailyTask"
          },
          "description": "Stores daily tasks assigned to a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user assigned the task."
            },
            {
              "name": "dailyTaskId",
              "description": "The unique identifier for the daily task."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support the SmartLearn AI platform, emphasizing authorization independence, clear data ownership, and efficient querying. Authorization Independence is achieved via path-based ownership for user-specific data. This eliminates the need for `get()` calls in security rules, ensuring atomic operations. Segregation via path-based ownership also enhances security and optimizes `list` operations. User-generated content is organized hierarchically under user-specific paths (`/users/{userId}/topics/{topicId}/roadmaps/{roadmapId}` etc.) to enforce clear ownership and facilitate secure, efficient queries."
  }
}

    